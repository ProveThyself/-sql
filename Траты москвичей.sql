CREATE DATABASE IF NOT EXISTS my_database;
USE my_database;

CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    city VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS cities (
    city_id INT AUTO_INCREMENT PRIMARY KEY,
    nameCity VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS amounts (
    user_id INT,
    amount DECIMAL(10, 2),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

INSERT INTO cities (nameCity) VALUES
('Москва'),
('Санкт-Петербург'),
('Новосибирск'),
('Екатеринбург'),
('Казань'),
('Нижний Новгород'),
('Челябинск'),
('Омск'),
('Ростов-на-Дону'),
('Уфа'),
('Красноярск'),
('Воронеж'),
('Пермь'),
('Саратов'),
('Тольятти'),
('Ижевск'),
('Барнаул'),
('Ульяновск'),
('Ярославль'),
('Томск'),
('Тула'),
('Калуга'),
('Магнитогорск'),
('Сочи'),
('Архангельск'),
('Владивосток'),
('Севастополь'),
('Симферополь'),
('Астрахань'),
('Чебоксары'),
('Набережные Челны'),
('Сургут'),
('Кострома'),
('Брянск'),
('Тверь'),
('Томск'),
('Нижний Тагил'),
('Кемерово'),
('Липецк'),
('Ставрополь'),
('Якутск'),
('Хабаровск'),
('Мурманск');

INSERT INTO users (name, city) VALUES
('Алексей', 'Москва'),
('Мария', 'Москва'),
('Иван', 'Санкт-Петербург'),
('Ольга', 'Москва'),
('Дмитрий', 'Казань'),
('Елена', 'Москва'),
('Сергей', 'Нижний Новгород'),
('Анна', 'Москва'),
('Артем', 'Челябинск'),
('Татьяна', 'Москва'),
('Николай', 'Уфа'),
('Ксения', 'Ростов-на-Дону'),
('Роман', 'Москва'),
('Виктор', 'Омск'),
('Светлана', 'Москва'),
('Денис', 'Воронеж'),
('Евгений', 'Томск'),
('Анастасия', 'Пермь'),
('Павел', 'Саратов'),
('Юлия', 'Новосибирск');

INSERT INTO amounts (user_id, amount) VALUES
(1, 150.00), (1, 200.00), (1, 300.00),
(2, 250.00), (2, 100.00), (2, 50.00),
(3, 400.00), (4, 150.00), (5, 500.00),
(6, 300.00), (7, 200.00), (8, 100.00),
(9, 600.00), (10, 250.00), (11, 700.00),
(12, 350.00), (13, 450.00), (14, 550.00),
(15, 300.00), (16, 400.00), (17, 250.00),
(18, 600.00), (19, 700.00), (20, 800.00),
(1, 50.00), (2, 75.00), (3, 125.00),
(4, 175.00), (5, 225.00), (6, 275.00),
(7, 325.00), (8, 375.00), (9, 425.00),
(10, 475.00), (11, 525.00), (12, 575.00),
(13, 625.00), (14, 675.00), (15, 725.00),
(16, 775.00), (17, 825.00), (18, 875.00),
(19, 925.00), (20, 975.00),
(1, 1000.00), (1, 1100.00), (1, 1200.00),
(2, 1300.00), (2, 1400.00), (2, 1500.00),
(3, 1600.00), (4, 1700.00), (5, 1800.00),
(6, 1900.00), (7, 2000.00), (8, 2100.00),
(9, 2200.00), (10, 2300.00), (11, 2400.00),
(12, 2500.00), (13, 2600.00), (14, 2700.00),
(15, 2800.00), (16, 2900.00), (17, 3000.00),
(18, 3100.00), (19, 3200.00), (20, 3300.00),
(1, 3400.00), (2, 3500.00), (3, 3600.00),
(4, 3700.00), (5, 3800.00), (6, 3900.00),
(7, 4000.00), (8, 4100.00), (9, 4200.00),
(10, 4300.00), (11, 4400.00), (12, 4500.00),
(13, 4600.00), (14, 4700.00), (15, 4800.00),
(16, 4900.00), (17, 5000.00), (18, 5100.00),
(19, 5200.00), (20, 5300.00);

-- Запрос для получения информации о москвичах и их тратах
SELECT u.name AS user_name,
       SUM(a.amount) AS total_amount
FROM users u
JOIN amounts a ON u.id = a.user_id
WHERE u.city = 'Москва'
GROUP BY u.id;